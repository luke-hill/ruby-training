Fully implementing the Rules engine
